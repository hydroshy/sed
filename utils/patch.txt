*** Begin Patch
*** Update File: tools/camera_tool.py
@@
-class CameraTool(BaseTool):
+class CameraTool(BaseTool):
+    # Supported pixel formats
+    SUPPORTED_FORMATS = ["RGB888", "BGR888", "XRGB8888", "YUV420", "NV12"]
@@
     def setup_config(self) -> None:
         """Thi???t l??-p c???u hA?nh m???c ???<nh cho Camera Tool"""
         # Camera settings
         self.config.set_default("frame_size", (1440, 1080))
-        self.config.set_default("format", "BGR888")
+        self.config.set_default("format", "BGR888")
+        # Enforce supported pixel formats only
+        try:
+            self.config.set_validator("format", lambda v: str(v) in CameraTool.SUPPORTED_FORMATS)
+        except Exception:
+            pass
         self.config.set_default("exposure_time", 10000)  # in microseconds
         self.config.set_default("frame_rate", 60)
@@
-        if "format" in self.config and hasattr(self.camera_manager, 'camera_stream') \
+        if "format" in self.config and hasattr(self.camera_manager, 'camera_stream') \
            and self.camera_manager.camera_stream and hasattr(self.camera_manager.camera_stream, 'set_format'):
             try:
-                self.camera_manager.camera_stream.set_format(self.config["format"])
+                fmt = str(self.config["format"]) if not isinstance(self.config, dict) else str(self.config["format"]) \
+                    if "format" in self.config else "BGR888"
+                if fmt not in CameraTool.SUPPORTED_FORMATS:
+                    logger.warning(f"Unsupported pixel format '{fmt}', falling back to 'BGR888'")
+                    fmt = "BGR888"
+                    try:
+                        self.config.set("format", fmt)
+                    except Exception:
+                        pass
+                self.current_format = fmt
+                self.camera_manager.camera_stream.set_format(fmt)
             except Exception as e:
                 logger.warning(f"Could not apply pixel format: {e}")
@@
-                if "format" in new_config and hasattr(self.camera_manager, 'camera_stream') and \
+                if "format" in new_config and hasattr(self.camera_manager, 'camera_stream') and \
                    self.camera_manager.camera_stream and hasattr(self.camera_manager.camera_stream, 'set_format'):
                     try:
-                        pf = new_config['format']
-                        print(f"DEBUG: [CameraTool] Updating pixel format to {pf}")
-                        self.camera_manager.camera_stream.set_format(pf)
+                        pf = str(new_config['format'])
+                        if pf not in CameraTool.SUPPORTED_FORMATS:
+                            logger.warning(f"Requested unsupported pixel format '{pf}', ignoring")
+                        else:
+                            print(f"DEBUG: [CameraTool] Updating pixel format to {pf}")
+                            self.current_format = pf
+                            self.camera_manager.camera_stream.set_format(pf)
                     except Exception as e:
                         logger.warning(f"Failed to update pixel format: {e}")
*** End Patch